!function(e){var t={};function s(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(a,r,function(t){return e[t]}.bind(null,r));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=12)}([function(e,t){e.exports=window.eejs.i18n},function(e,t){e.exports=window.wp.element},function(e,t,s){e.exports=s(13)()},function(e,t){e.exports=function(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}},function(e,t){e.exports=window.wp.components},function(e,t){e.exports=window.eejs.model},function(e,t){e.exports=window.eejs.components},function(e,t){e.exports=window.wp.blocks},function(e,t){e.exports=window.wp.blockEditor},function(e,t){e.exports=window.wp.data},function(e,t){e.exports=window.eejs.editorHocs},function(e,t){e.exports=window.lodash},function(e,t,s){e.exports=s(15)},function(e,t,s){"use strict";var a=s(14);function r(){}function n(){}n.resetWarningCache=r,e.exports=function(){function e(e,t,s,r,n,i){if(i!==a){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var s={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:n,resetWarningCache:r};return s.PropTypes=s,s}},function(e,t,s){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,s){"use strict";s.r(t);var a=s(7),r=s(0),n=s(3),i=s.n(n),o=s(1),l=s(8),c=s(4),d=s(9),u=s(6),p=s(10),v=s(5),h=s(2),b=s.n(h),m=s(11);const _={showExpired:!0,limit:50},y=({eventId:e,datetimeId:t,ticketId:s})=>0===e&&0===t&&0===s,f=[];let O=200;class g extends o.Component{constructor(e){super(e),i()(this,"setEventId",e=>{const t=null!==e&&e.value?parseInt(e.value,10):0;this.props.setAttributes({eventId:t,datetimeId:0,ticketId:0}),this.setState({datetimeQueryData:{...this.state.datetimeQueryData,forEventId:t}})}),i()(this,"setDatetimeId",e=>{const t=null!==e&&e.value?parseInt(e.value,10):0;this.props.setAttributes({datetimeId:t,ticketId:0}),this.setState({ticketQueryData:{...this.state.ticketQueryData,forDatetimeId:t}})}),i()(this,"setTicketId",e=>{const t=null!==e&&e.value?parseInt(e.value,10):0;this.props.setAttributes({ticketId:t})}),i()(this,"setStatus",e=>{const t=null!==e&&e.value?e.value:v.statusModel.REGISTRATION_STATUS_ID.APPROVED;this.props.setAttributes({status:t})}),i()(this,"setLimit",e=>{this.props.setAttributes({limit:parseInt(e,10)})}),i()(this,"setOrderBy",e=>{this.props.setAttributes({orderBy:e})}),i()(this,"setOrder",e=>{this.props.setAttributes({order:e})}),i()(this,"setAvatarSize",e=>{this.props.setAttributes({avatarSize:parseInt(e,10)})}),i()(this,"toggleShowGravatar",e=>{this.props.setAttributes({showGravatar:e})}),i()(this,"toggleDisplayOnArchives",e=>{this.props.setAttributes({displayOnArchives:e})});const{eventId:t,datetimeId:s}=this.props.attributes;this.state={eventQueryData:{..._},datetimeQueryData:{..._,forEventId:t},ticketQueryData:{..._,forDatetimeId:s},statusQueryData:{..._,statusType:v.statusModel.STATUS_TYPE_REGISTRATION}}}getAttendeesDisplay(){const{isLoading:e,attendees:t}=this.props,{showGravatar:s,avatarSize:a,avatarClass:n}=this.props.attributes,i={avatarWidth:a,avatarHeight:a,avatarClass:n};return e?Object(o.createElement)(c.Placeholder,null,Object(o.createElement)(c.Spinner,null)):y(this.props.attributes)&&t===f?Object(o.createElement)(c.Placeholder,null,Object(r.__)("To get started, select what event you want to show attendees from in the block settings.","event_espresso")):!e&&Object(m.isEmpty)(t)?Object(o.createElement)(c.Placeholder,null,Object(r.__)("There are no attendees for selected options.","event_espresso")):Object(o.createElement)(u.EventAttendeeList,{attendees:this.applyLimit(t),showGravatar:s,avatarOptions:i,isLoading:e,containerCssClass:"ee-core-blocks event-espresso-blocks",containerId:"ee-block-event-attendees"})}applyLimit(e){return e.length<=this.props.attributes.limit?e:e.slice(0,this.props.attributes.limit)}getInspectorControls(e){const t=this.props.attendees.length||0;return Object(o.createElement)(l.InspectorControls,null,Object(o.createElement)(c.PanelBody,{title:Object(r.__)("Filter By Settings","event_espresso")},Object(o.createElement)(u.EditorEventSelect,{key:"attendees-event-select",selected:e.eventId,onSelect:this.setEventId,queryData:this.state.eventQueryData}),0!==e.eventId&&Object(o.createElement)(u.EditorDatetimeSelect,{key:"attendees-datetime-select",selected:e.datetimeId,onSelect:this.setDatetimeId,queryData:this.state.datetimeQueryData}),0!==e.datetimeId&&Object(o.createElement)(u.EditorTicketSelect,{key:"attendees-ticket-select",selected:e.ticketId,onSelect:this.setTicketId,queryData:this.state.ticketQueryData}),Object(o.createElement)(u.EditorStatusSelect,{key:"attendees-status-select",selected:e.status,onSelect:this.setStatus,queryData:this.state.statusQueryData,label:Object(r.__)("Select Registration Status","event_espresso")}),Object(o.createElement)(u.QueryLimit,{label:Object(r.__)("Number of Attendees to Display:","event_espresso"),limit:e.limit,onLimitChange:this.setLimit,min:1,withSlider:!1,help:Object(r.sprintf)(Object(r._n)("Used to adjust the number of attendees displayed (There is %d total attendee for the current filter settings).","Used to adjust the number of attendees displayed (There are %d total attendees for the current filter settings).",t,"event_espresso"),t)}),Object(o.createElement)(c.SelectControl,{label:Object(r.__)("Order Attendees by:","event_espresso"),value:e.orderBy,options:[{label:Object(r.__)("Attendee id","event_espresso"),value:"id"},{label:Object(r.__)("Last name only","event_espresso"),value:"lastNameOnly"},{label:Object(r.__)("First name only","event_espresso"),value:"firstNameOnly"},{label:Object(r.__)("First, then Last name","event_espresso"),value:"firstThenLastName"},{label:Object(r.__)("Last, then First name","event_espresso"),value:"lastThenFirstName"}],onChange:this.setOrderBy}),Object(o.createElement)(c.SelectControl,{label:Object(r.__)("Sort order:","event_espresso"),value:e.order,options:[{label:Object(r.__)("Ascending","event_espresso"),value:v.QUERY_ORDER_ASC},{label:Object(r.__)("Descending","event_espresso"),value:v.QUERY_ORDER_DESC}],onChange:this.setOrder})),Object(o.createElement)(c.PanelBody,{title:Object(r.__)("Gravatar Setttings","event_espresso")},Object(o.createElement)(c.ToggleControl,{label:Object(r.__)("Display Gravatar","event_espresso"),checked:e.showGravatar,onChange:this.toggleShowGravatar,help:e.showGravatar?Object(r.__)("Gravatar images are shown for each attendee.","event_espresso"):Object(r.__)("No gravatar images are shown for each attendee.","event_espresso")}),e.showGravatar&&Object(o.createElement)(c.RangeControl,{label:Object(r.__)("Size of Gravatar","event_espresso"),value:e.avatarSize,min:10,max:128,onChange:this.setAvatarSize})),Object(o.createElement)(p.NotWithPostTypeCheck,{excludedPostTypeSlugs:"page"},Object(o.createElement)(c.PanelBody,{title:Object(r.__)("Archive Settings","event_espresso")},Object(o.createElement)(c.ToggleControl,{label:Object(r.__)("Display on Archives","event_espresso"),checked:e.displayOnArchives,onChange:this.toggleDisplayOnArchives,help:e.displayOnArchives?Object(r.__)("Attendees are shown whenever this post is listed in an archive view.","event_espresso"):Object(r.__)("Attendees are hidden whenever this post is listed in an archive view.","event_espresso")}))))}render(){return Object(o.createElement)(o.Fragment,null,this.getAttendeesDisplay(),this.getInspectorControls(this.props.attributes))}}i()(g,"propTypes",{attendees:b.a.array,isLoading:b.a.bool,attributes:b.a.shape({eventId:b.a.number,datetimeId:b.a.number,ticketId:b.a.number,status:b.a.string,showGravatar:b.a.bool,displayOnArchives:b.a.bool,limit:b.a.number,orderBy:b.a.oneOf(["id","lastNameOnly","firstNameOnly","firstThenLastName","lastThenFirstName"]),order:b.a.oneOf(v.ALLOWED_ORDER_VALUES),avatarSize:b.a.number,avatarClass:b.a.string})}),i()(g,"defaultProps",{attendees:[],isLoading:!0,attributes:{eventId:0,datetimeId:0,ticketId:0,status:v.statusModel.REGISTRATION_STATUS_ID.APPROVED,showGravatar:!0,displayOnArchives:!1,limit:100,orderBy:"lastThenFirstName",order:v.QUERY_ORDER_ASC,avatarSize:24,avatarClass:"contact"}});var j=Object(d.withSelect)((e,t)=>{const s={...g.defaultProps.attributes},{eventId:a=s.eventId,datetimeId:r=s.datetimeId,ticketId:n=s.ticketId,status:i=s.status,orderBy:o=s.orderBy,order:l=s.order,limit:c=s.limit}=t.attributes;O=!c||isNaN(c)||c<=O?O:c;const d={forEventId:a,forDatetimeId:r,forTicketId:n,forStatusId:i,showGravatar:!0,defaultWhereConditions:"full_this_minimum_others",order:l,orderBy:o,limit:O},u=v.attendeeModel.getQueryString(d),{getAttendees:p,isRequestingAttendees:h}=e("eventespresso/lists");return{...g.defaultProps,...t,attributes:{...g.defaultProps.attributes,...t.attributes},attendees:y({eventId:a,datetimeId:r,ticketId:n})?f:p(u),isLoading:h(u)}})(g);const I={title:Object(r.__)("Event Attendees","event_espresso"),description:Object(r.__)("Displays a list of people that have registered for the specified event","event_espresso"),icon:"groups",category:"event-espresso",keywords:[Object(r.__)("event","event_espresso"),Object(r.__)("attendees","event_espresso"),Object(r.__)("list","event_espresso")],attributes:{eventId:{type:"number",default:0},datetimeId:{type:"number",default:0},ticketId:{type:"number",default:0},status:{type:"string",default:"RAP"},limit:{type:"number",default:100},order:{type:"string",default:"ASC"},orderBy:{type:"string",default:"lastThenFirstName"},showGravatar:{type:"boolean",default:!1},avatarClass:{type:"string",default:"contact"},avatarSize:{type:"number",default:24},displayOnArchives:{type:"boolean",default:!1}},edit:j,save:()=>null};Object(a.registerBlockType)("eventespresso/event-attendees",I)}]);