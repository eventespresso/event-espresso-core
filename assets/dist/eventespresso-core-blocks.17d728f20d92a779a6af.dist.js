!function(){var e={713:function(e){e.exports=function(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}},703:function(e,t,s){"use strict";var a=s(414);function r(){}function n(){}n.resetWarningCache=r,e.exports=function(){function e(e,t,s,r,n,i){if(i!==a){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var s={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:n,resetWarningCache:r};return s.PropTypes=s,s}},697:function(e,t,s){e.exports=s(703)()},414:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},t={};function s(a){var r=t[a];if(void 0!==r)return r.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,s),n.exports}s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,{a:t}),t},s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=window.wp.blocks,t=window.eejs.i18n,a=s(713),r=s.n(a),n=window.wp.element,i=window.wp.blockEditor,o=window.wp.components,l=window.wp.data,d=window.eejs.components,p=window.eejs.editorHocs,u=window.eejs.model,c=s(697),h=s.n(c),v=window.lodash;const m={showExpired:!0,limit:50},_=({eventId:e,datetimeId:t,ticketId:s})=>0===e&&0===t&&0===s,y=[];let f=200;class b extends n.Component{constructor(e){super(e),r()(this,"setEventId",(e=>{const t=null!==e&&e.value?parseInt(e.value,10):0;this.props.setAttributes({eventId:t,datetimeId:0,ticketId:0}),this.setState({datetimeQueryData:{...this.state.datetimeQueryData,forEventId:t}})})),r()(this,"setDatetimeId",(e=>{const t=null!==e&&e.value?parseInt(e.value,10):0;this.props.setAttributes({datetimeId:t,ticketId:0}),this.setState({ticketQueryData:{...this.state.ticketQueryData,forDatetimeId:t}})})),r()(this,"setTicketId",(e=>{const t=null!==e&&e.value?parseInt(e.value,10):0;this.props.setAttributes({ticketId:t})})),r()(this,"setStatus",(e=>{const t=null!==e&&e.value?e.value:u.statusModel.REGISTRATION_STATUS_ID.APPROVED;this.props.setAttributes({status:t})})),r()(this,"setLimit",(e=>{this.props.setAttributes({limit:parseInt(e,10)})})),r()(this,"setOrderBy",(e=>{this.props.setAttributes({orderBy:e})})),r()(this,"setOrder",(e=>{this.props.setAttributes({order:e})})),r()(this,"setAvatarSize",(e=>{this.props.setAttributes({avatarSize:parseInt(e,10)})})),r()(this,"toggleShowGravatar",(e=>{this.props.setAttributes({showGravatar:e})})),r()(this,"toggleDisplayOnArchives",(e=>{this.props.setAttributes({displayOnArchives:e})}));const{eventId:t,datetimeId:s}=this.props.attributes;this.state={eventQueryData:{...m},datetimeQueryData:{...m,forEventId:t},ticketQueryData:{...m,forDatetimeId:s},statusQueryData:{...m,statusType:u.statusModel.STATUS_TYPE_REGISTRATION}}}getAttendeesDisplay(){const{isLoading:e,attendees:s}=this.props,{showGravatar:a,avatarSize:r,avatarClass:i}=this.props.attributes,l={avatarWidth:r,avatarHeight:r,avatarClass:i};return e?(0,n.createElement)(o.Placeholder,null,(0,n.createElement)(o.Spinner,null)):_(this.props.attributes)&&s===y?(0,n.createElement)(o.Placeholder,null,(0,t.__)("To get started, select what event you want to show attendees from in the block settings.","event_espresso")):!e&&(0,v.isEmpty)(s)?(0,n.createElement)(o.Placeholder,null,(0,t.__)("There are no attendees for selected options.","event_espresso")):(0,n.createElement)(d.EventAttendeeList,{attendees:this.applyLimit(s),showGravatar:a,avatarOptions:l,isLoading:e,containerCssClass:"ee-core-blocks event-espresso-blocks",containerId:"ee-block-event-attendees"})}applyLimit(e){return e.length<=this.props.attributes.limit?e:e.slice(0,this.props.attributes.limit)}getInspectorControls(e){const s=this.props.attendees.length||0;return(0,n.createElement)(i.InspectorControls,null,(0,n.createElement)(o.PanelBody,{title:(0,t.__)("Filter By Settings","event_espresso")},(0,n.createElement)(d.EditorEventSelect,{key:"attendees-event-select",selected:e.eventId,onSelect:this.setEventId,queryData:this.state.eventQueryData}),0!==e.eventId&&(0,n.createElement)(d.EditorDatetimeSelect,{key:"attendees-datetime-select",selected:e.datetimeId,onSelect:this.setDatetimeId,queryData:this.state.datetimeQueryData}),0!==e.datetimeId&&(0,n.createElement)(d.EditorTicketSelect,{key:"attendees-ticket-select",selected:e.ticketId,onSelect:this.setTicketId,queryData:this.state.ticketQueryData}),(0,n.createElement)(d.EditorStatusSelect,{key:"attendees-status-select",selected:e.status,onSelect:this.setStatus,queryData:this.state.statusQueryData,label:(0,t.__)("Select Registration Status","event_espresso")}),(0,n.createElement)(d.QueryLimit,{label:(0,t.__)("Number of Attendees to Display:","event_espresso"),limit:e.limit,onLimitChange:this.setLimit,min:1,withSlider:!1,help:(0,t.sprintf)((0,t._n)("Used to adjust the number of attendees displayed (There is %d total attendee for the current filter settings).","Used to adjust the number of attendees displayed (There are %d total attendees for the current filter settings).",s,"event_espresso"),s)}),(0,n.createElement)(o.SelectControl,{label:(0,t.__)("Order Attendees by:","event_espresso"),value:e.orderBy,options:[{label:(0,t.__)("Attendee id","event_espresso"),value:"id"},{label:(0,t.__)("Last name only","event_espresso"),value:"lastNameOnly"},{label:(0,t.__)("First name only","event_espresso"),value:"firstNameOnly"},{label:(0,t.__)("First, then Last name","event_espresso"),value:"firstThenLastName"},{label:(0,t.__)("Last, then First name","event_espresso"),value:"lastThenFirstName"}],onChange:this.setOrderBy}),(0,n.createElement)(o.SelectControl,{label:(0,t.__)("Sort order:","event_espresso"),value:e.order,options:[{label:(0,t.__)("Ascending","event_espresso"),value:u.QUERY_ORDER_ASC},{label:(0,t.__)("Descending","event_espresso"),value:u.QUERY_ORDER_DESC}],onChange:this.setOrder})),(0,n.createElement)(o.PanelBody,{title:(0,t.__)("Gravatar Setttings","event_espresso")},(0,n.createElement)(o.ToggleControl,{label:(0,t.__)("Display Gravatar","event_espresso"),checked:e.showGravatar,onChange:this.toggleShowGravatar,help:e.showGravatar?(0,t.__)("Gravatar images are shown for each attendee.","event_espresso"):(0,t.__)("No gravatar images are shown for each attendee.","event_espresso")}),e.showGravatar&&(0,n.createElement)(o.RangeControl,{label:(0,t.__)("Size of Gravatar","event_espresso"),value:e.avatarSize,min:10,max:128,onChange:this.setAvatarSize})),(0,n.createElement)(p.NotWithPostTypeCheck,{excludedPostTypeSlugs:"page"},(0,n.createElement)(o.PanelBody,{title:(0,t.__)("Archive Settings","event_espresso")},(0,n.createElement)(o.ToggleControl,{label:(0,t.__)("Display on Archives","event_espresso"),checked:e.displayOnArchives,onChange:this.toggleDisplayOnArchives,help:e.displayOnArchives?(0,t.__)("Attendees are shown whenever this post is listed in an archive view.","event_espresso"):(0,t.__)("Attendees are hidden whenever this post is listed in an archive view.","event_espresso")}))))}render(){return(0,n.createElement)(n.Fragment,null,this.getAttendeesDisplay(),this.getInspectorControls(this.props.attributes))}}r()(b,"propTypes",{attendees:h().array,isLoading:h().bool,attributes:h().shape({eventId:h().number,datetimeId:h().number,ticketId:h().number,status:h().string,showGravatar:h().bool,displayOnArchives:h().bool,limit:h().number,orderBy:h().oneOf(["id","lastNameOnly","firstNameOnly","firstThenLastName","lastThenFirstName"]),order:h().oneOf(u.ALLOWED_ORDER_VALUES),avatarSize:h().number,avatarClass:h().string})}),r()(b,"defaultProps",{attendees:[],isLoading:!0,attributes:{eventId:0,datetimeId:0,ticketId:0,status:u.statusModel.REGISTRATION_STATUS_ID.APPROVED,showGravatar:!0,displayOnArchives:!1,limit:100,orderBy:"lastThenFirstName",order:u.QUERY_ORDER_ASC,avatarSize:24,avatarClass:"contact"}});var I=(0,l.withSelect)(((e,t)=>{const s={...b.defaultProps.attributes},{eventId:a=s.eventId,datetimeId:r=s.datetimeId,ticketId:n=s.ticketId,status:i=s.status,orderBy:o=s.orderBy,order:l=s.order,limit:d=s.limit}=t.attributes;f=!d||isNaN(d)||d<=f?f:d;const p={forEventId:a,forDatetimeId:r,forTicketId:n,forStatusId:i,showGravatar:!0,defaultWhereConditions:"full_this_minimum_others",order:l,orderBy:o,limit:f},c=u.attendeeModel.getQueryString(p),{getAttendees:h,isRequestingAttendees:v}=e("eventespresso/lists");return{...b.defaultProps,...t,attributes:{...b.defaultProps.attributes,...t.attributes},attendees:_({eventId:a,datetimeId:r,ticketId:n})?y:h(c),isLoading:v(c)}}))(b);const g={title:(0,t.__)("Event Attendees","event_espresso"),description:(0,t.__)("Displays a list of people that have registered for the specified event","event_espresso"),icon:"groups",category:"event-espresso",keywords:[(0,t.__)("event","event_espresso"),(0,t.__)("attendees","event_espresso"),(0,t.__)("list","event_espresso")],attributes:{eventId:{type:"number",default:0},datetimeId:{type:"number",default:0},ticketId:{type:"number",default:0},status:{type:"string",default:"RAP"},limit:{type:"number",default:100},order:{type:"string",default:"ASC"},orderBy:{type:"string",default:"lastThenFirstName"},showGravatar:{type:"boolean",default:!1},avatarClass:{type:"string",default:"contact"},avatarSize:{type:"number",default:24},displayOnArchives:{type:"boolean",default:!1}},edit:I,save:()=>null};(0,e.registerBlockType)("eventespresso/event-attendees",g)}()}();