(this.webpackJsonproot=this.webpackJsonproot||[]).push([[26],{1791:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var a=i(3),c=i(5),n=i(16),r=i(1),s=function(t){var e=t.ticket,i=Object(n.useRegistrationsLink)({ticket_id:e.dbId}),s=Object(a.__)("total registrations."),o=Object(a.__)("view ALL registrations for this ticket.");return Object(r.jsx)(c.ItemCount,{count:e.registrationCount,emphasizeZero:!1,title:s,children:Object(r.jsx)(c.RegistrationsLink,{href:i,tooltip:o})})}},1792:function(t,e,i){"use strict";var a=i(46),c=i(34),n=i.n(c),r=i(0),s=i(3),o=i(18),u=i(5),l=i(16),d=i(182),b=i(1);e.a=function(t){var e=t.entity,i=Object(l.useTicketMutator)(e.id).updateEntity,c=Object(d.useSystemNotifications)(),j=Object(l.useCappedQuantity)(),O=Object(r.useCallback)(function(){var t=Object(a.a)(n.a.mark((function t(a){var r,u,l,d;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Object(o.parseInfinity)(a),u=j({quantity:r,ticketId:e.id}),l=u!==r,d=u!==e.quantity,l&&c.info({message:Object(s.__)("Ticket quantity has been adjusted because it cannot be more than the related event date capacity.")}),!d&&!l){t.next=8;break}return t.next=8,i({quantity:u});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[j,e.id,e.quantity,c,i]);return Object(b.jsx)(u.InlineEditInfinity,{"data-testid":"ee-ticket-inline-qty",onChange:O,tooltip:Object(s.__)("edit quantity of tickets available\u2026"),value:"".concat(e.quantity)},e.cacheId)}},1793:function(t,e,i){"use strict";i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return v}));var a=i(0),c=i(3),n=i(16),r=i(5),s=i(1),o=function(t){var e=t.className,i=t["data-testid"],o=t.entity,u=t.view,l=void 0===u?"card":u,d=Object(n.useTicketMutator)(o.id).updateEntity,b="card"===l&&2,j=Object(a.useCallback)((function(t){t!==o.name&&d({name:t})}),[o.name,d]);return Object(s.jsx)(r.InlineEditText,{className:e,"data-testid":i,lineCount:b,onChange:j,tag:"table"===l?"div":"h4",tooltip:Object(c.__)("click to edit title\u2026"),value:o.name||Object(c.__)("add title\u2026")})},u=i(27),l=i(67),d=i(25),b=i(23),j=i(13),O=i(90),p=i(26),y=i(2),k=i(46),f=i(34),m=i.n(f),_=function(t){var e=Object(n.useLazyTicket)(),i=Object(n.useTicketPrices)(),c=Object(O.useInitialState)({ticketId:t,getTicket:e,getTicketPrices:i}),r=Object(O.useDefaultBasePrice)(),s=Object(O.useMutatePrices)(),o=Object(n.useTicketMutator)(t).updateEntity;return Object(a.useCallback)(function(){var t=Object(k.a)(m.a.mark((function t(e){var i,a,n,u,l,d,b,k,f;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=c(null),n=Object(y.a)(Object(y.a)({},a.ticket),{},{price:e}),a=Object(y.a)(Object(y.a)({},a),{},{ticket:n}),u=Object(j.getBasePrice)(a.prices),l=Object(j.getPriceModifiers)(a.prices),d=Object(O.calculateBasePrice)(null===(i=a.ticket)||void 0===i?void 0:i.price,a.prices),b=u?Object(y.a)(Object(y.a)({},u),{},{isModified:!0}):Object(y.a)(Object(y.a)({},r),{},{order:1,isNew:!0}),k=[Object(y.a)(Object(y.a)({},b),{},{amount:d})].concat(Object(p.a)(l)),t.next=10,s(k);case 10:return f=t.sent,t.next=13,o({price:e,reverseCalculate:!0,prices:f});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[r,c,s,o])},v=function(t){var e=t.entity,i=t.className,n=Object(b.useMoneyDisplay)(),o=n.afterAmount,p=n.beforeAmount,y=n.localizeMoney,k=n.parseLocalizedMoney,f=n.currency,m=_(e.id),v=Object(a.useCallback)((function(t){if(t&&"amount"in t){var i=Math.abs(parseFloat(t.amount.toString()));i!==e.price&&m(i)}}),[m,e.price]),x=Object(O.useLockedTicketAction)(e,"COPY/TRASH"),h=x.alertContainer,g=x.showAlert,C=Object(d.useMemoStringify)({className:i}),E=Object(j.isLocked)(e),T=Object(c.__)("edit ticket total\u2026"),M=Object(a.useMemo)((function(){var t=f.decimalMark,e=f.thousandsSeparator,i=/\s/.test(e)?"\\s":e,a="."===t?".":t;return new RegExp("^[0-9".concat(i,"]*").concat(a,"?[0-9]{0,6}$"))}),[f]);return E?Object(s.jsxs)(u.Clickable,{as:"div",className:"ee-ticket-editable-price",onClick:g,children:[Object(s.jsx)(l.CurrencyDisplay,{className:i,value:e.price}),h]}):Object(s.jsx)(r.InlineEditCurrency,{afterAmount:o,amount:e.price,beforeAmount:p,pattern:M,parseAmount:k,formatAmount:y,id:e.id,placeholder:Object(c.__)("set price\u2026"),wrapperProps:C,onChange:v,tag:"h3",tooltip:T})}},1796:function(t,e,i){"use strict";var a=i(2),c=i(8),n=i(5),r=i(467),s=function(t){return Object(r.b)("ticket",t)},o=i(1);e.a=function(t){var e=t.entity,i=Object(c.a)(t,["entity"]),r=s(e);return Object(o.jsx)(n.EntityActionsMenu,Object(a.a)(Object(a.a)({},i),{},{menuItems:r}))}},1800:function(t,e,i){"use strict";i.r(e);var a=i(5),c=i(16),n=i(0),r=i(241),s=i(2),o=i(3),u=i(39),l=i(67),d=i(1793),b=i(1791),j=i(1),O=function(t){var e=t.ticket,i=Object(c.useRegistrationsLink)({ticket_id:e.dbId,_reg_status:c.QueryURLRegStatus.APPROVED}),n=Object(o.__)("view approved registrations for this ticket.");return Object(j.jsx)(a.RegistrationsLink,{href:i,tooltip:n,children:e.sold})},p=i(1792),y=function(t){var e=t.entity,i=Object(n.useMemo)((function(){return[{id:"ee-ticket-sold",label:Object(o.__)("sold"),value:Object(j.jsx)(O,{ticket:e})},{id:"ee-ticket-qty",label:Object(o.__)("quantity"),value:Object(j.jsx)(p.a,{entity:e})},{id:"ee-ticket-registrations",label:Object(o.__)("reg list"),value:Object(j.jsx)(b.a,{ticket:e})}]}),[e]);return Object(j.jsx)(a.EntityDetailsPanel,{details:i,className:"ee-editor-ticket-details-sold-rsrvd-qty-div"})},k=function(t){var e=t.entity,i=Object(c.useTicketMutator)(e.id).updateEntity,a=Object(n.useCallback)((function(t){i({description:t})}),[i]),r=Object(n.useMemo)((function(){return c.hooks.applyFilters("eventEditor.tickets.inlineDescriptionProps",u.EMPTY_OBJECT,e)}),[e]);return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(d.a,{className:"entity-card-details__name",entity:e}),Object(j.jsx)(l.SimpleTextEditorModal,Object(s.a)({className:"entity-card-details__text",onUpdate:a,text:e.description,title:Object(o.__)("Edit description"),tooltip:Object(o.__)("click to edit description\u2026"),placeholder:Object(o.__)("add description\u2026")},r)),Object(j.jsx)(d.b,{className:"entity-card-details__price",entity:e}),Object(j.jsx)(y,{entity:e})]})},f=i(6),m=i(23),_=function(t){var e=t.entity,i=Object(c.useTicketsListFilterState)().displayStartOrEndDate,a=Object(c.useTicketMutator)(e.id).updateEntity,s=Object(m.useTimeZoneTime)().siteTimeToUtc,u=Object(n.useCallback)((function(t){var e=Object(f.a)(t,2),i=e[0],c=e[1],n=s(i).toISOString(),r=s(c).toISOString();a({startDate:n,endDate:r})}),[s,a]),d=Object(r.getTicketStatusTextLabel)(e),b=Object(n.useMemo)((function(){return{headerFuture:"start"===i?Object(o.__)("sales start"):Object(o.__)("sales end"),headerPast:"start"===i?Object(o.__)("sales began"):e.isExpired?Object(o.__)("sales ended"):Object(o.__)("sales end")}}),[e.isExpired,i]);return e?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(l.CalendarDateSwitcher,{displayDate:i,labels:b,endDate:e.endDate,startDate:e.startDate}),Object(j.jsx)(l.EditDateRangeButton,{endDate:e.endDate,header:Object(o.__)("Edit Ticket Sale Dates"),onChange:u,popoverPlacement:"left-end",startDate:e.startDate,tooltip:Object(o.__)("edit ticket sales start and end dates")}),Object(j.jsx)("div",{className:"ee-entity-status-label",children:d})]}):null},v=i(1796),x=function(t){var e=t.id,i=Object(c.useTicketItem)({id:e}),s=Object(r.ticketStatusBgColorClassName)(i),o=Object(n.useMemo)((function(){return i.name.length>0?i.name:"ticket"}),[i]),u=a.EntityPaperFrame.Contexts.AriaLabel.Provider;return i?Object(j.jsx)(u,{value:o,children:Object(j.jsx)(a.EntityCard,{actionsMenu:Object(j.jsx)(v.a,{entity:i,layout:a.EntityActionsMenuLayout.Vertical}),details:Object(j.jsx)(k,{entity:i}),entity:i,reverse:!0,sidebar:Object(j.jsx)(_,{entity:i}),sidebarClass:s})}):null};e.default=function(){var t=Object(c.useFilteredTicketIds)();return Object(j.jsx)(a.EntityCardList,{EntityCard:x,entityIds:t})}}}]);
//# sourceMappingURL=tickets-card-view.ed1fec47.chunk.js.map