(this.webpackJsonproot=this.webpackJsonproot||[]).push([[7],{1893:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(63),i=a(3),s=a(6),c=a(16),r=a(1),l=function(e){var t,a=e.datetime,l=Object(c.useRelatedTickets)()({entity:"datetimes",entityId:a.id}),o=0,u=Object(n.a)(l);try{for(u.s();!(t=u.n()).done;){o+=t.value.registrationCount}}catch(O){u.e(O)}finally{u.f()}var b=Object(c.useRegistrationsLink)({datetime_id:a.dbId}),d=Object(i.__)("total registrations."),j=Object(i.__)("view ALL registrations for this date.");return Object(r.jsx)(s.ItemCount,{count:o,emphasizeZero:!1,title:d,children:Object(r.jsx)(s.RegistrationsLink,{href:b,tooltip:j})})}},1894:function(e,t,a){"use strict";var n=a(2),i=a(49),s=a(40),c=a.n(s),r=a(0),l=a(3),o=a(17),u=a(6),b=a(16),d=a(1);t.a=function(e){var t=e.entity,a=Object(b.useDatetimeMutator)(t.id).updateEntity,s=Object(b.useUpdateTicketQtyByCapacity)(),j=s.createBulkQtyUpdateInput,O=s.doQtyBulkUpdate,m=Object(r.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(i){var s,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((s=Object(o.parseInfinity)(i))===t.capacity){e.next=7;break}return e.next=4,a({capacity:s});case 4:return r=j(Object(n.a)(Object(n.a)({},t),{},{capacity:s})),e.next=7,O(r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,a,j,O]),p=Object(l.sprintf)(Object(l.__)("click to edit capacity%s(registration limit)\u2026"),"\n");return Object(d.jsx)(u.InlineEditInfinity,{"data-testid":"ee-datetime-inline-cap",onChange:m,tooltip:p,value:"".concat(t.capacity)})}},1898:function(e,t,a){"use strict";var n=a(2),i=a(9),s=a(6),c=a(887),r=function(e){return Object(c.a)("datetime",e)},l=a(1);t.a=function(e){var t=e.entity,a=Object(i.a)(e,["entity"]),c=r(t);return Object(l.jsx)(s.EntityActionsMenu,Object(n.a)(Object(n.a)({},a),{},{menuItems:c}))}},1899:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(0),i=a(3),s=a(16),c=a(6),r=a(1),l=function(e){var t=e.className,a=e["data-testid"],l=e.entity,o=e.view,u=void 0===o?"card":o,b=Object(s.useDatetimeMutator)(l.id).updateEntity,d="card"===u&&2,j=Object(n.useCallback)((function(e){e!==l.name&&b({name:e})}),[l.name,b]);return Object(r.jsx)(c.InlineEditText,{className:t,"data-testid":a,lineCount:d,onChange:j,tag:"table"===u?"div":"h4",tooltip:Object(i.__)("click to edit title\u2026"),value:l.name||Object(i.__)("add title\u2026")})}},1902:function(e,t,a){"use strict";a.r(t);var n=a(3),i=a(70),s=a(16),c=a(31),r=a(0),l=a(10),o=a.n(l),u=a(203),b=a(4),d=a(6),j=a(43),O=a(283),m=a(13),p=a(1893),y=a(1898),f=a(1894),_=a(1899),v=a(2),h=a(5),k=a(1),x=Object(c.withCurrentUserCan)(j.USE_ADVANCED_EDITOR)((function(e){var t=Object(s.useVisibleDatetimeIds)(),a=Object(h.a)(t,1)[0];return Object(k.jsx)(i.ActionCheckbox,Object(v.a)(Object(v.a)({},e),{},{visibleEntityIds:a}))})),g=Object(d.addZebraStripesOnMobile)(["row","stripe","name","actions"]),C=function(){var e=Object(s.useDatetimes)(),t=Object(r.useCallback)((function(t){return Object(m.findEntityByGuid)(e)(t)}),[e]),a=Object(s.useLazyDatetime)(),n=Object(c.useFeature)("ee_event_editor_bulk_edit"),i=Object(c.useTimeZoneTime)().formatForSite;return Object(r.useCallback)((function(e){var c=e.entityId,r=e.filterState,l=t(c)||a(c),d=r.displayStartOrEndDate,m=Object(O.getDatetimeBackgroundColorClassName)(l),v=l.dbId||0,h=Object(O.datetimeStatus)(l),C=[{className:o()("ee-entity-list-status-stripe",m),key:"stripe",showValueOnMobile:!0,textAlign:"center",value:l.name},n&&{key:"cell",size:"micro",textAlign:"center",value:Object(k.jsx)(x,{dbId:l.dbId,id:l.id})},{key:"id",size:"micro",textAlign:"end",value:v},{className:"ee-col-name ee-rspnsv-table-hide-on-mobile",key:"name",size:"huge",value:Object(k.jsx)(_.a,{className:"ee-entity-name ee-entity-list-text ee-focus-priority-5","data-testid":"ee-entity-list-view-row-editable-".concat(l.dbId),entity:l,view:"table"})},{key:"start",size:"default",value:i(Object(u.a)(l.startDate),j.ENTITY_LIST_DATE_TIME_FORMAT)},{key:"end",size:"default",value:i(Object(u.a)(l.endDate),j.ENTITY_LIST_DATE_TIME_FORMAT)},{className:"ee-col__inline-edit",key:"capacity",size:"tiny",textAlign:"end",value:Object(k.jsx)(f.a,{entity:l})},{key:"sold",size:"tiny",textAlign:"end",value:l.sold||0},{key:"registrations",size:"smaller",textAlign:"center",value:Object(k.jsx)(p.a,{datetime:l})},{key:"actions",size:"big",textAlign:"center",value:Object(k.jsx)(y.a,{entity:l})}].filter(Boolean),D=b.filter(Object(s.filterCellByStartOrEndDate)(d));return{cells:b.pipe(D,g)(C),className:{bodyRowClassName:h},"data-testid":"ee-datetime-list-view-row-".concat(l.dbId),id:"ee-editor-datetime-list-view-row-".concat(l.id),key:"row-".concat(l.id),rowClassName:"ee-entity-list-item",type:"row"}}),[n,i,t,a])},D=function(){var e=Object(c.useFeature)("ee_event_editor_bulk_edit"),t=Object(r.useMemo)((function(){return{className:"ee-entity-list-status-stripe",key:"stripe",size:"nano",textAlign:"center",value:""}}),[]),a=Object(r.useMemo)((function(){return{key:"id",size:"micro",textAlign:"end",value:Object(n.__)("ID")}}),[]),i=Object(r.useMemo)((function(){return{key:"name",size:"huge",value:Object(n.__)("Name")}}),[]),l=Object(r.useMemo)((function(){return{key:"start",size:"default",value:Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("span",{className:"ee-rspnsv-table-long-label",children:Object(n.__)("Start Date")}),Object(k.jsx)("span",{className:"ee-rspnsv-table-short-label",children:Object(n.__)("Start")})]})}}),[]),o=Object(r.useMemo)((function(){return{key:"end",size:"default",value:Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("span",{className:"ee-rspnsv-table-long-label",children:Object(n.__)("End Date")}),Object(k.jsx)("span",{className:"ee-rspnsv-table-short-label",children:Object(n.__)("End")})]})}}),[]),u=Object(r.useMemo)((function(){return{className:"ee-col__inline-edit",key:"capacity",size:"tiny",textAlign:"end",value:Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("span",{className:"ee-rspnsv-table-long-label",children:Object(n.__)("Capacity")}),Object(k.jsx)("span",{className:"ee-rspnsv-table-short-label",children:Object(n.__)("Cap")})]})}}),[]),b=Object(r.useMemo)((function(){return{key:"sold",size:"tiny",textAlign:"end",value:Object(n.__)("Sold")}}),[]),d=Object(r.useMemo)((function(){return{key:"registrations",size:"smaller",textAlign:"center",value:Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("span",{className:"ee-rspnsv-table-long-label",children:Object(n.__)("Reg list")}),Object(k.jsx)("span",{className:"ee-rspnsv-table-short-label",children:Object(n.__)("Regs")})]})}}),[]),j=Object(r.useMemo)((function(){return{key:"actions",size:"big",textAlign:"center",value:Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("span",{className:"ee-rspnsv-table-long-label",children:Object(n.__)("Actions")}),Object(k.jsx)("span",{className:"ee-rspnsv-table-short-label",children:Object(n.__)("Actions")})]})}}),[]);return Object(r.useCallback)((function(n){var c=n.displayStartOrEndDate;return{cells:[t,e&&{key:"checkbox",size:"micro",textAlign:"center",value:Object(k.jsx)("div",{className:"ee-rspnsv-table-hide-on-mobile",children:Object(k.jsx)(x,{})})},a,i,l,o,u,b,d,j].filter(Boolean).filter(Object(s.filterCellByStartOrEndDate)(c)),className:"ee-editor-date-list-items-header-row",key:"dates-list-header",primary:!0,type:"row"}}),[j,e,u,o,a,i,d,b,l,t])},E=a(33),A=a(56),T=a(1878),w=a(1764),I=a(1879),N=a(49),S=a(40),B=a.n(S),z=a(258),F=a(89),M=function(){var e=Object(N.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(F.yupToFinalFormErrors)(L,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=z.b({name:z.c().min(3,(function(){return Object(n.__)("Name must be at least three characters")}))}),R=Object(A.intervalsToOptions)(b.pick(["months","weeks","days","hours","minutes"],A.DATE_INTERVALS),!0),U=function(e){var t=e.onSubmit,a=Object(r.useCallback)((function(e,a){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];return t.apply(void 0,[e,a].concat(i))}),[t]),i=Object(E.useMemoStringify)({className:"ee-form-item-pair"});return Object(r.useMemo)((function(){return Object(v.a)(Object(v.a)({},e),{},{onSubmit:a,validate:M,layout:"horizontal",sections:[{name:"basics",icon:T.a,title:Object(n.__)("Basics"),fields:[{name:"name",label:Object(n.__)("Name"),fieldType:"text",min:3},{name:"description",label:Object(n.__)("Description"),fieldType:"simple-text-editor"}]},{name:"dates",icon:w.a,title:Object(n.__)("Dates"),fields:[{name:"shiftDates",label:Object(n.__)("Shift dates"),fieldType:"group",formControlProps:{className:"shift-dates"},subFields:[{name:"value",min:0,fieldType:"number"},{name:"unit",fieldType:"select",options:R},{name:"type",fieldType:"select",options:[{label:"",value:""},{label:Object(n.__)("earlier"),value:"earlier"},{label:Object(n.__)("later"),value:"later"}]}]}]},{name:"details",icon:I.a,title:Object(n.__)("Details"),fields:[{name:"capacity",label:Object(n.__)("Capacity"),fieldType:"number",parseAsInfinity:!0,min:-1,formControlProps:i}]}]})}),[i,e,a])},Q=a(20),V=a(17),G=function(e){var t=Object(c.useBulkEdit)(),a=t.getSelected,n=t.unSelectAll,i=Object(s.useDatetimes)(),l=Object(s.useBulkEditDatetimes)().updateEntities,o=Object(s.useUpdateTicketQtyByCapacity)(),u=o.createBulkQtyUpdateInput,b=o.doQtyBulkUpdate;return Object(r.useCallback)(function(){var t=Object(N.a)(B.a.mark((function t(c){var r,o;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(),r=Object(s.formToBulkUpdateInput)(c,i,a()),n(),t.next=5,l(r);case 5:if(Object(V.isInfinite)(c.capacity)){t.next=9;break}return o=a().reduce((function(e,t){var a=u({id:t,capacity:c.capacity});return[].concat(Object(Q.a)(e),Object(Q.a)(a))}),[]),t.next=9,b(o);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[i,u,b,a,e,n,l])},Z=function(e){var t=e.onClose,a=e.isOpen,s=G(t),c=U({onSubmit:s});return Object(k.jsx)(i.BulkEditDetails,{formConfig:c,isOpen:a,onClose:t,title:Object(n.__)("Bulk edit date details"),warning:Object(n.__)("any changes will be applied to ALL of the selected dates.")})},J=function(e){var t=e.areTrashedDates,a=e.onClose,n=Object(c.useBulkEdit)(),i=n.getSelected,l=n.unSelectAll,o=Object(s.useBulkDeleteDatetimes)();return Object(r.useCallback)((function(){a(),l(),o(i(),t)}),[t,o,i,a,l])},P=function(e){var t=e.areTrashedDates,a=e.onClose,i=J({areTrashedDates:t,onClose:a}),s=Object(d.useConfirmationDialog)({message:t?Object(n.__)("Are you sure you want to permanently delete these datetimes? This action can NOT be undone!"):Object(n.__)("Are you sure you want to trash these datetimes?"),title:t?Object(n.__)("Delete datetimes permanently"):Object(n.__)("Trash datetimes"),onConfirm:i,onCancel:a}),c=s.confirmationDialog,l=s.onOpen;return Object(r.useEffect)((function(){return l()}),[]),Object(k.jsx)(k.Fragment,{children:c})},Y=["edit-details","delete",""],q=Object(c.withCurrentUserCan)(j.USE_ADVANCED_EDITOR)((function(){var e=Object(r.useState)(""),t=Object(h.a)(e,2),a=t[0],l=t[1],o=Object(c.useBulkEdit)(),u=Object(c.useFeature)("ee_event_editor_bulk_edit"),b=Object(E.useDisclosure)(),d=b.isOpen,j=b.onOpen,O=b.onClose,p=Object(s.useDatesListFilterState)().status===m.DatetimeStatus.trashedOnly,y=Object(E.useMemoStringify)(s.hooks.applyFilters("eventEditor.datetimes.bulkEdit.actions",[{value:"",label:Object(n.__)("bulk actions")},{value:"edit-details",label:Object(n.__)("edit datetime details")},{value:"delete",label:p?Object(n.__)("delete datetimes"):Object(n.__)("trash datetimes")}])),f=Object(r.useCallback)((function(e){l(e),Y.includes(e)&&j(),s.hooks.doAction("eventEditor.datetimes.bulkEdit.apply",e,o)}),[o,j]);return u&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(i.BulkActions,{Checkbox:x,defaultAction:"",id:"ee-bulk-edit-dates-actions",onApply:f,options:y}),Object(k.jsxs)(k.Fragment,{children:["edit-details"===a&&Object(k.jsx)(Z,{isOpen:d,onClose:O}),"delete"===a&&Object(k.jsx)(P,{areTrashedDates:p,onClose:O})]})]})}));t.default=Object(c.withBulkEdit)((function(){var e=Object(s.useDatesListFilterState)(),t=Object(s.useFilteredDateIds)(),a=C(),c=D();return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(q,{}),Object(k.jsx)(i.EntityTable,{bodyRowGenerator:a,domain:s.domain,entityIds:t,filterState:e,headerRowGenerator:c,listId:s.datesList,tableCaption:Object(n.__)("Event Dates"),tableId:"date-entities-table-view"})]})}))}}]);
//# sourceMappingURL=dates-table-view.10c79866.chunk.js.map